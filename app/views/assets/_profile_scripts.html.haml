:javascript

  $(function() {
    $.fn.editable.defaults.mode = 'inline';
    $.fn.editable.defaults.clear = false;
    $.fn.editable.defaults.savenochange = true;

    $('.editable-field.combodate').editable({
        template: 'MMM D YYYY',    
        viewformat: 'MM/DD/YYYY',
        combodate: {
          maxYear: (new Date()).getFullYear()
        }
    });

    $('.editable-field.required').editable({
        validate: function(value) {
           if($.trim(value) == '') return 'This field is required';
        }
    });
    $('.editable-field').editable({});
    $('.not-editable-field').editable('disable');

    // select all text when editable input shows up so to speed up input
    $('.editable-field').on('shown', function(e, editable) {
      setTimeout( function() {
        editable.input.$input.select();
      }, 10 );
    });

    // click an editable cell to bring up editable-input
    $('.editable-field:not(.editable-disabled)').closest('td').click(function() {
      if (editableActive) return;
      
      var that = this;
      setTimeout(function() {
        $(that).find('.editable-field').editable('show');
        }, 10);
    });

    // if the cell is editable enabled, show up editable input when it gets focus
    $('.editable-field:not(.editable-disabled)').focus(function() {
      $(this).editable('show');
    });

    function show_fields_segment_unit_type_changes(segment_unit_type_id) {
      if (parseInt(segment_unit_type_id) == parseInt('#{InfrastructureSegmentUnitType.find_by(name: "Marker Posts").try(:id)}')) {
        $('.segment-unit-type-marker-posts').show();
        $('.segment-unit-type:not(.segment-unit-type-marker-posts)').hide();
      } else if (parseInt(segment_unit_type_id) == parseInt('#{InfrastructureSegmentUnitType.find_by(name: "Chaining").try(:id)}')) {
        $('.segment-unit-type-chaining').show();
        $('.segment-unit-type:not(.segment-unit-type-chaining)').hide();
      } else {
        $('.segment-unit-type-lat-long').show();
        $('.segment-unit-type:not(.segment-unit-type-lat-long)').hide();
      }
    }
    show_fields_segment_unit_type_changes($("input[name='infrastructure_segment_unit_type_id']:checked").val());

    $("input[name='infrastructure_segment_unit_type_id']").on("click", function(value) {
      show_fields_segment_unit_type_changes($(this).val());
    });
  });